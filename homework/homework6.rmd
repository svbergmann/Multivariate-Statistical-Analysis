---
title: "Multivariate Statistical Analysis"
subtitle: "Homework 6"
author: Lucas Fellmeth, Helen Kafka, Sven Bergmann
date: 04/17/24
output: pdf_document
---

```{r, echo = F}
library(knitr)
opts_chunk$set(tidy.opts = list(width.cutoff = 60), tidy = TRUE)
```
# Problem 1

## a)

Carry out a hierarchical agglomerative cluster analysis of the ``primate_scapulae`` data using complete linkage.
Use the variables AD.BD, AD.CD, EA.CD, Dx.CD, SH.ACR, EAD and $\beta$ only.
(Remember to scale the variables prior to clustering.)
Does the dendrogram suggest a definite number of clusters as the best solution?
If not, what would be reasonable solutions?

```{r}
primate_sculpae <- read.csv(file = '../Data_csv/primate_scapulae.csv')
```
```{r}
primate_sculpae$class <- factor(primate_sculpae$class)
primate_sculpae <- subset(primate_sculpae, select = c(AD.BD, AD.CD, EA.CD, Dx.CD, SH.ACR, EAD, beta, class))
primate_sculpae[, 1:7] <- scale(primate_sculpae[, 1:7])
head(primate_sculpae)
```

```{r}
D <- dist(primate_sculpae[, 1:7])
hc <- hclust(D, method = 'complete')
plot(hc, hang = -1)
```

The dendrogram does not suggest a definite number of clusters as best solution,
instead, we would probably cut off at ``height = 5`` (k = 5 clusters)
because it seems that the 5 clusters survive the longest.

## b)

Decide on a reasonable solution in part (a) and assess that solution using a silhouette plot.

```{r}
clusters <- cutree(hc, k = 5)
plot(cluster::silhouette(clusters, dist = D))
```

The average silhouette width is 0.37 which is not too good.

## c)

Is there any correspondence between the clusters obtained above
and the primate species as indicated by the variable class?

```{r}
table(clusters, primate_sculpae$class)
```

- Cluster 1 has almost all values of the group "Hylobates" and also just values of this group.
- Cluster 2 is kind of an intermediate cluster, no group really belongs there. Some values of the groups "Homo", "Hylobates" and "Pongo" are in there.
- Cluster 3 has most of the group "Pongo" but also one value of the group "Homo".
- Cluster 4 has two groups, "Gorillas" as well as "Pan".
- Cluster 5 fully belongs to the group "Homo".
